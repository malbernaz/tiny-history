{"version":3,"file":"index.js","sources":["../index.js"],"sourcesContent":["function createURL(path) {\n  try {\n    return path ? new URL(path, location) : new URL(location);\n  } catch (error) {\n    const link = document.createElement(\"a\");\n    link.href = path || location.href;\n\n    return {\n      pathname: link.pathname,\n      search: link.search,\n      hash: link.hash\n    };\n  }\n}\n\nexport default class BrowserHistory {\n  constructor() {\n    this.listeners = [];\n    this.location = this.createLocation();\n    this.entries = [this.location];\n\n    this.go = index => history.go(index);\n    this.back = () => history.back();\n    this.forward = () => history.forward();\n\n    this.handlePopState = ({ state }) => {\n      this.location = state || this.entries[0];\n      this.listeners.forEach(listener => listener(this.location, \"POP\"));\n    };\n\n    this.firstLocation = true;\n  }\n\n  get length() {\n    return this.entries.length;\n  }\n\n  listen(listener) {\n    if (typeof listener !== \"function\") {\n      throw new Error(\"listener must be a function\");\n    }\n\n    this.listeners.push(listener);\n\n    if (this.listeners.length === 1) {\n      addEventListener(\"popstate\", this.handlePopState, false);\n    }\n\n    return () => {\n      this.listeners = this.listeners.filter(\n        (l, i) => i !== this.listeners.indexOf(listener)\n      );\n\n      if (!this.listeners.length) {\n        removeEventListener(\"popstate\", this.handlePopState);\n      }\n    };\n  }\n\n  createLocation(path, state) {\n    const newLocation = { state: state || null };\n\n    let newURL;\n    if (path === undefined) {\n      newURL = createURL();\n    } else {\n      const key = Math.random().toString(36).substr(2, 5);\n      newURL = createURL(path);\n      newLocation.key = key;\n    }\n\n    newLocation.pathname = newURL.pathname;\n    newLocation.search = newURL.search;\n    newLocation.hash = newURL.hash;\n\n    return newLocation;\n  }\n\n  push(path, state) {\n    this.location = this.createLocation(path, state);\n    this.entries.push(this.location);\n    history.pushState(this.location, null, path);\n    this.listeners.forEach(listener => listener(this.location, \"PUSH\"));\n  }\n\n  replace(path, state) {\n    this.location = this.createLocation(path, state);\n    this.entries.pop();\n    this.entries.push(this.location);\n    history.replaceState(this.location, null, path);\n    this.listeners.forEach(listener => listener(this.location, \"REPLACE\"));\n  }\n}\n"],"names":["createURL","path","URL","location","error","const","link","document","createElement","href","pathname","search","hash","BrowserHistory","this","listeners","createLocation","entries","go","index","history","back","forward","handlePopState","ref","state","this$1","forEach","listener","firstLocation","prototypeAccessors","length","listen","Error","push","addEventListener","filter","l","i","indexOf","removeEventListener","newURL","newLocation","undefined","key","Math","random","toString","substr","pushState","replace","pop","replaceState"],"mappings":"mLAAA,SAASA,EAAUC,GACjB,IACE,OAAOA,EAAO,IAAIC,IAAID,EAAME,UAAY,IAAID,IAAIC,UAChD,MAAOC,GACPC,IAAMC,EAAOC,SAASC,cAAc,KAGpC,OAFAF,EAAKG,KAAOR,GAAQE,SAASM,MAG3BC,SAAUJ,EAAKI,SACfC,OAAQL,EAAKK,OACbC,KAAMN,EAAKM,OAKjB,IAAqBC,EAAe,sBAElCC,KAAOC,aACPD,KAAOX,SAAWW,KAAKE,iBACvBF,KAAOG,SAAWH,KAAKX,UAEvBW,KAAOI,GAAK,SAAAC,UAASC,QAAQF,GAAGC,IAChCL,KAAOO,KAAO,kBAAMD,QAAQC,QAC5BP,KAAOQ,QAAU,kBAAMF,QAAQE,WAE/BR,KAAOS,eAAiB,SAACC,OAAEC,UACzBC,EAAOvB,SAAWsB,GAASX,EAAKG,QAAQ,GACxCS,EAAOX,UAAUY,QAAQ,SAAAC,UAAYA,EAASd,EAAKX,SAAU,UAG/DW,KAAOe,eAAgB,wBAGzBC,EAAEC,sBACA,OAASjB,KAAKG,QAAQc,QAGxBlB,YAAEmB,gBAAOJ,cACP,GAA0B,mBAAbA,EACX,MAAYK,MAAM,+BASpB,OANAnB,KAAOC,UAAUmB,KAAKN,GAEU,IAA1Bd,KAAKC,UAAUgB,QACnBI,iBAAmB,WAAYrB,KAAKS,gBAAgB,GAG7C,WACPG,EAAOX,UAAYD,EAAKC,UAAUqB,OAChC,SAAGC,EAAGC,UAAMA,IAAMxB,EAAKC,UAAUwB,QAAQX,KAGpCd,EAAKC,UAAUgB,QACpBS,oBAAsB,WAAY1B,EAAKS,kBAK7CV,YAAEG,wBAAef,EAAMwB,GACrB,IAEMgB,EAFEC,GAAgBjB,MAAOA,GAAS,MAGxC,QAAekB,IAAT1C,EACJwC,EAAWzC,QACJ,CACP,IAAQ4C,EAAMC,KAAKC,SAASC,SAAS,IAAIC,OAAO,EAAG,GACnDP,EAAWzC,EAAUC,GACrByC,EAAcE,IAAMA,EAOtB,OAJAF,EAAchC,SAAW+B,EAAO/B,SAChCgC,EAAc/B,OAAS8B,EAAO9B,OAC9B+B,EAAc9B,KAAO6B,EAAO7B,KAEnB8B,GAGX7B,YAAEqB,cAAKjC,EAAMwB,cACXX,KAAOX,SAAWW,KAAKE,eAAef,EAAMwB,GAC5CX,KAAOG,QAAQiB,KAAKpB,KAAKX,UACzBiB,QAAU6B,UAAUnC,KAAKX,SAAU,KAAMF,GACzCa,KAAOC,UAAUY,QAAQ,SAAAC,UAAYA,EAASd,EAAKX,SAAU,WAG/DU,YAAEqC,iBAAQjD,EAAMwB,cACdX,KAAOX,SAAWW,KAAKE,eAAef,EAAMwB,GAC5CX,KAAOG,QAAQkC,MACfrC,KAAOG,QAAQiB,KAAKpB,KAAKX,UACzBiB,QAAUgC,aAAatC,KAAKX,SAAU,KAAMF,GAC5Ca,KAAOC,UAAUY,QAAQ,SAAAC,UAAYA,EAASd,EAAKX,SAAU"}