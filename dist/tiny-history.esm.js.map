{"version":3,"file":"tiny-history.esm.js","sources":["../index.js"],"sourcesContent":["let a;\n\nfunction createLocation(path, state) {\n  a = a || document.createElement(\"a\");\n  a.href = path || location.href;\n\n  return {\n    state: state || null,\n    pathname:\n      \"/\" +\n      (a.pathname || location.pathname)\n        .split(\"/\")\n        .filter(Boolean)\n        .join(\"/\"),\n    search: a.search,\n    hash: a.hash,\n    key:\n      path &&\n      Math.random()\n        .toString(36)\n        .substr(2, 5)\n  };\n}\n\nexport default function createHistory() {\n  let listeners = [],\n    location = createLocation(),\n    entries = [location],\n    action;\n\n  function callListeners() {\n    listeners.forEach(listener => listener(location, action));\n  }\n\n  function handlePopState(e) {\n    location = e.state || entries[0];\n    action = \"POP\";\n    callListeners();\n  }\n\n  return {\n    get length() {\n      return entries.length;\n    },\n    get location() {\n      return location;\n    },\n    get action() {\n      return action;\n    },\n    listen(listener) {\n      listeners.push(listener);\n\n      if (listeners.length === 1) {\n        addEventListener(\"popstate\", handlePopState, false);\n      }\n\n      return () => {\n        listeners.splice(listeners.indexOf(listener), 1);\n\n        if (!listeners.length) {\n          removeEventListener(\"popstate\", handlePopState);\n        }\n      };\n    },\n    push(path, state) {\n      location = createLocation(path, state);\n      entries.push(location);\n      history.pushState(location, null, path);\n      action = \"PUSH\";\n      callListeners();\n    },\n    replace(path, state) {\n      location = createLocation(path, state);\n      entries.pop();\n      entries.push(location);\n      history.replaceState(location, null, path);\n      action = \"REPLACE\";\n      callListeners();\n    },\n    go(i) {\n      history.go(i);\n    },\n    back() {\n      history.back();\n    },\n    forward() {\n      history.forward();\n    }\n  };\n}\n"],"names":["createLocation","path","state","a","document","createElement","href","location","pathname","split","filter","Boolean","join","search","hash","key","Math","random","toString","substr","createHistory","callListeners","listeners","forEach","listener","action","handlePopState","e","entries","let","length","listen","push","addEventListener","splice","indexOf","removeEventListener","history","pushState","replace","pop","replaceState","go","i","back","forward"],"mappings":"AAEA,QAASA,gBAAeC,EAAMC,GAI5B,MAHAC,GAAIA,GAAKC,SAASC,cAAc,KAChCF,EAAEG,KAAOL,GAAQM,SAASD,MAGxBJ,MAAOA,GAAS,KAChBM,SACE,KACCL,EAAEK,UAAYD,SAASC,UACrBC,MAAM,KACNC,OAAOC,SACPC,KAAK,KACVC,OAAQV,EAAEU,OACVC,KAAMX,EAAEW,KACRC,IACEd,GACAe,KAAKC,SACFC,SAAS,IACTC,OAAO,EAAG,IAInB,QAAwBC,iBAMtB,QAASC,KACPC,EAAUC,QAAQ,SAAAC,SAAYA,GAASjB,EAAUkB,KAGnD,QAASC,GAAeC,GACtBpB,EAAWoB,EAAEzB,OAAS0B,EAAQ,GAC9BH,EAAS,MACTJ,IAZFQ,GAGEJ,GAHEH,KACFf,EAAWP,iBACX4B,GAAWrB,EAab,QACEuB,aACE,MAAOF,GAAQE,QAEjBvB,eACE,MAAOA,IAETkB,aACE,MAAOA,IAETM,gBAAOP,GAOL,MANAF,GAAUU,KAAKR,GAEU,IAArBF,EAAUQ,QACZG,iBAAiB,WAAYP,GAAgB,GAGxC,WACLJ,EAAUY,OAAOZ,EAAUa,QAAQX,GAAW,GAEzCF,EAAUQ,QACbM,oBAAoB,WAAYV,KAItCM,cAAK/B,EAAMC,GACTK,EAAWP,eAAeC,EAAMC,GAChC0B,EAAQI,KAAKzB,GACb8B,QAAQC,UAAU/B,EAAU,KAAMN,GAClCwB,EAAS,OACTJ,KAEFkB,iBAAQtC,EAAMC,GACZK,EAAWP,eAAeC,EAAMC,GAChC0B,EAAQY,MACRZ,EAAQI,KAAKzB,GACb8B,QAAQI,aAAalC,EAAU,KAAMN,GACrCwB,EAAS,UACTJ,KAEFqB,YAAGC,GACDN,QAAQK,GAAGC,IAEbC,gBACEP,QAAQO,QAEVC,mBACER,QAAQQ,YAvFdhB,GAAI1B"}