{"version":3,"file":"tiny-history.esm.js","sources":["../index.js"],"sourcesContent":["let a = document.createElement(\"a\");\n\nfunction createLocation(path, state) {\n  a.href = path || location.href;\n\n  return {\n    state: state || null,\n    pathname:\n      \"/\" +\n      (a.pathname || location.pathname)\n        .split(\"/\")\n        .filter(Boolean)\n        .join(\"/\"),\n    search: a.search,\n    hash: a.hash,\n    key:\n      path &&\n      Math.random()\n        .toString(36)\n        .substr(2, 5)\n  };\n}\n\nexport default function createHistory() {\n  let listeners = [],\n    location = createLocation(),\n    entries = [location],\n    action;\n\n  function callListeners() {\n    listeners.forEach(listener => listener(location, action));\n  }\n\n  function handlePopState(e) {\n    location = e.state || entries[0];\n    action = \"POP\";\n    callListeners();\n  }\n\n  function listen(listener) {\n    listeners.push(listener);\n\n    if (listeners.length === 1) {\n      addEventListener(\"popstate\", handlePopState, false);\n    }\n\n    return () => {\n      listeners.splice(listeners.indexOf(listener), 1);\n\n      if (!listeners.length) {\n        removeEventListener(\"popstate\", handlePopState);\n      }\n    };\n  }\n\n  function push(path, state) {\n    location = createLocation(path, state);\n    entries.push(location);\n    history.pushState(location, null, path);\n    action = \"PUSH\";\n    callListeners();\n  }\n\n  function replace(path, state) {\n    location = createLocation(path, state);\n    entries.pop();\n    entries.push(location);\n    history.replaceState(location, null, path);\n    action = \"REPLACE\";\n    callListeners();\n  }\n\n  return {\n    go: i => history.go(i),\n    back: () => history.back(),\n    forward: () => history.forward(),\n    get length() {\n      return entries.length;\n    },\n    get location() {\n      return location;\n    },\n    get action() {\n      return action;\n    },\n    listen,\n    push,\n    replace\n  };\n}\n"],"names":["createLocation","path","state","a","href","location","pathname","split","filter","Boolean","join","search","hash","key","Math","random","toString","substr","createHistory","callListeners","listeners","forEach","listener","action","handlePopState","e","entries","listen","push","length","addEventListener","splice","indexOf","removeEventListener","history","pushState","replace","pop","replaceState","let","go","i","back","forward","document","createElement"],"mappings":"AAEA,QAASA,gBAAeC,EAAMC,GAG5B,MAFAC,GAAEC,KAAOH,GAAQI,SAASD,MAGxBF,MAAOA,GAAS,KAChBI,SACE,KACCH,EAAEG,UAAYD,SAASC,UACrBC,MAAM,KACNC,OAAOC,SACPC,KAAK,KACVC,OAAQR,EAAEQ,OACVC,KAAMT,EAAES,KACRC,IACEZ,GACAa,KAAKC,SACFC,SAAS,IACTC,OAAO,EAAG,IAInB,QAAwBC,iBAMtB,QAASC,KACPC,EAAUC,QAAQ,SAAAC,SAAYA,GAASjB,EAAUkB,KAGnD,QAASC,GAAeC,GACtBpB,EAAWoB,EAAEvB,OAASwB,EAAQ,GAC9BH,EAAS,MACTJ,IAGF,QAASQ,GAAOL,GAOd,MANAF,GAAUQ,KAAKN,GAEU,IAArBF,EAAUS,QACZC,iBAAiB,WAAYN,GAAgB,GAGxC,WACLJ,EAAUW,OAAOX,EAAUY,QAAQV,GAAW,GAEzCF,EAAUS,QACbI,oBAAoB,WAAYT,IAKtC,QAASI,GAAK3B,EAAMC,GAClBG,EAAWL,eAAeC,EAAMC,GAChCwB,EAAQE,KAAKvB,GACb6B,QAAQC,UAAU9B,EAAU,KAAMJ,GAClCsB,EAAS,OACTJ,IAGF,QAASiB,GAAQnC,EAAMC,GACrBG,EAAWL,eAAeC,EAAMC,GAChCwB,EAAQW,MACRX,EAAQE,KAAKvB,GACb6B,QAAQI,aAAajC,EAAU,KAAMJ,GACrCsB,EAAS,UACTJ,IA7CFoB,GAGEhB,GAHEH,KACFf,EAAWL,iBACX0B,GAAWrB,EA8Cb,QACEmC,GAAI,SAAAC,SAAKP,SAAQM,GAAGC,IACpBC,KAAM,iBAAMR,SAAQQ,QACpBC,QAAS,iBAAMT,SAAQS,WACvBd,aACE,MAAOH,GAAQG,QAEjBxB,eACE,MAAOA,IAETkB,aACE,MAAOA,IAETI,OAAAA,EACAC,KAAAA,EACAQ,QAAAA,GAvFJG,GAAIpC,GAAIyC,SAASC,cAAc"}